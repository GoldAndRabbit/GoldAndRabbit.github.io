<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  <title>QLoRA finetune codegen350M | G&amp;R Blog</title>
  <meta name="keywords" content="">
  <meta name="description" content="QLoRA finetune codegen350M | G&amp;R Blog">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="Overview1.BERT is basically a trained Transformer Encoder stack.   2.Both BERT model sizes have a large number of encoder layers (which the paper calls Transformer Blocks) – twelve for the Base ve">
<meta property="og:type" content="website">
<meta property="og:title" content="Bert">
<meta property="og:url" content="http://example.com/hist_articles/Bert.html">
<meta property="og:site_name" content="G&amp;R Blog">
<meta property="og:description" content="Overview1.BERT is basically a trained Transformer Encoder stack.   2.Both BERT model sizes have a large number of encoder layers (which the paper calls Transformer Blocks) – twelve for the Base ve">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s3.ax1x.com/2020/12/16/r1tx0A.png">
<meta property="og:image" content="https://s3.ax1x.com/2020/12/16/r1tWy4.png">
<meta property="og:image" content="https://s3.ax1x.com/2020/12/16/r1tcWT.png">
<meta property="og:image" content="https://s3.ax1x.com/2020/12/16/r1tfOJ.png">
<meta property="og:image" content="https://s3.ax1x.com/2020/12/16/r1tRlF.png">
<meta property="og:image" content="https://s3.ax1x.com/2020/12/16/r1t2SU.png">
<meta property="og:image" content="https://s3.ax1x.com/2020/12/16/r1tx0A.png">
<meta property="article:published_time" content="2020-12-16T13:56:00.000Z">
<meta property="article:modified_time" content="2025-04-28T09:12:10.794Z">
<meta property="article:author" content="G&amp;R">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s3.ax1x.com/2020/12/16/r1tx0A.png">


<link rel="icon" href="/img/fox.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="G&R Blog" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/fox.jpg"/>
</a>
<div class="author">
    <span>G&amp;R</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/goldandrabbit"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:goldandrabbit@foxmail.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(174)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="Ads_RecSys">
            
            Ads_RecSys
            <small>(34)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="AI">
            
            AI
            <small>(16)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Algorithm">
            
            Algorithm
            <small>(70)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Coding">
            
            Coding
            <small>(34)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Reading">
            
            Reading
            <small>(13)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Rethinking">
            
            Rethinking
            <small>(7)</small>
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
    </div>
    <div>
        
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="174">
<input type="hidden" id="yelog_site_word_count" value="352.1k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">叶落阁</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All Coding "
           href="/2025/02/01/Linux%20Access%20the%20Open%20Internet/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Linux Access the Open Internet">Linux Access the Open Internet</span>
            <span class="post-date" title="2025-02-01 20:43:00">2025/02/01</span>
        </a>
        
        
        <a  class="All Rethinking "
           href="/2024/12/29/2024%20Annual%20Summary/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="2024 Annual Summary">2024 Annual Summary</span>
            <span class="post-date" title="2024-12-29 09:00:00">2024/12/29</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2024/10/30/Ubuntu%2024.04%20Upgrade%20Log/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Ubuntu 24.04 Upgrade Log">Ubuntu 24.04 Upgrade Log</span>
            <span class="post-date" title="2024-10-30 20:00:00">2024/10/30</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2024/10/05/Coding%20Config/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Coding Config">Coding Config</span>
            <span class="post-date" title="2024-10-05 02:01:00">2024/10/05</span>
        </a>
        
        
        <a  class="All AI "
           href="/2024/10/03/QLoRA%20finetune%20codegen350M/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="QLoRA finetune codegen350M">QLoRA finetune codegen350M</span>
            <span class="post-date" title="2024-10-03 20:43:00">2024/10/03</span>
        </a>
        
        
        <a  class="All AI "
           href="/2024/10/02/Finetune%20GPT2%20on%20wiki-text/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Finetune GPT2 on wiki-text">Finetune GPT2 on wiki-text</span>
            <span class="post-date" title="2024-10-02 20:43:00">2024/10/02</span>
        </a>
        
        
        <a  class="All AI "
           href="/2024/10/01/Finetune%20bert%20using%20Trainer%20v.s.%20Pytorch%20train%20loop/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Finetune bert using Trainer v.s. Pytorch train loop">Finetune bert using Trainer v.s. Pytorch train loop</span>
            <span class="post-date" title="2024-10-01 20:43:00">2024/10/01</span>
        </a>
        
        
        <a  class="All AI "
           href="/2024/09/05/LLaMA/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="LLaMA">LLaMA</span>
            <span class="post-date" title="2024-09-05 20:00:00">2024/09/05</span>
        </a>
        
        
        <a  class="All AI "
           href="/2024/06/30/Large%20Language%20Model/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Large Language Model">Large Language Model</span>
            <span class="post-date" title="2024-06-30 20:00:00">2024/06/30</span>
        </a>
        
        
        <a  class="All AI "
           href="/2024/05/30/Decoder-only%20transformer/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Decoder-only transformer">Decoder-only transformer</span>
            <span class="post-date" title="2024-05-30 20:00:00">2024/05/30</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2024/03/22/Ubuntu%2022.04%20Upgrade%20Log/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Ubuntu 22.04 Upgrade Log">Ubuntu 22.04 Upgrade Log</span>
            <span class="post-date" title="2024-03-22 10:11:00">2024/03/22</span>
        </a>
        
        
        <a  class="All Rethinking "
           href="/2024/02/20/2023%20Annual%20Summary/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="2023 Annual Summary">2023 Annual Summary</span>
            <span class="post-date" title="2024-02-20 20:00:00">2024/02/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2024/01/20/CREAD%20A%20Classification-Restoration%20Framework%20with%20Error%20Adaptive%20Discretization%20for%20Watch%20Time%20Prediction%20in%20Video%20Recommender%20Systems/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CREAD A Classification-Restoration Framework with Error Adaptive Discretization for Watch Time Prediction in Video Recommender Systems">CREAD A Classification-Restoration Framework with Error Adaptive Discretization for Watch Time Prediction in Video Recommender Systems</span>
            <span class="post-date" title="2024-01-20 20:20:00">2024/01/20</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2024/01/11/%E4%BB%8E%E6%89%BE%E4%BA%8B%E7%90%86%E8%AE%BA%E5%88%B0%20TRIZ/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="从找事理论到 TRIZ">从找事理论到 TRIZ</span>
            <span class="post-date" title="2024-01-11 20:11:00">2024/01/11</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/12/30/Joint%20Optimization%20of%20Ranking%20and%20Calibration%20with%20Contextualized%20Hybrid%20Model/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Joint Optimization of Ranking and Calibration with Contextualized Hybrid Model">Joint Optimization of Ranking and Calibration with Contextualized Hybrid Model</span>
            <span class="post-date" title="2023-12-30 20:43:00">2023/12/30</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/11/20/Multi-Scenario%20Ranking%20with%20Adaptive%20Feature%20Learning/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Multi-Scenario Ranking with Adaptive Feature Learning">Multi-Scenario Ranking with Adaptive Feature Learning</span>
            <span class="post-date" title="2023-11-20 20:08:00">2023/11/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/11/20/Towards%20Deeper,%20Lighter%20and%20Interpretable%20Cross%20Network%20for%20CTR%20Prediction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Towards Deeper, Lighter and Interpretable Cross Network for CTR Prediction">Towards Deeper, Lighter and Interpretable Cross Network for CTR Prediction</span>
            <span class="post-date" title="2023-11-20 20:08:00">2023/11/20</span>
        </a>
        
        
        <a  class="All AI "
           href="/2023/10/20/Self-Attention%20with%20Relative%20Position%20Representations/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Self-Attention with Relative Position Representations">Self-Attention with Relative Position Representations</span>
            <span class="post-date" title="2023-10-20 20:08:00">2023/10/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/10/15/RankFlow%20Joint%20Optimization%20of%20Multi-Stage%20Cascade%20Ranking%20Systems%20as%20Flows/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="RankFlow Joint Optimization of Multi-Stage Cascade Ranking Systems as Flows">RankFlow Joint Optimization of Multi-Stage Cascade Ranking Systems as Flows</span>
            <span class="post-date" title="2023-10-15 13:08:00">2023/10/15</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/10/11/SHARK%20A%20Lightweight%20Model%20Compression%20Approach%20for%20Large-scale%20Recommender%20Systems/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SHARK A Lightweight Model Compression Approach for Large-scale Recommender Systems">SHARK A Lightweight Model Compression Approach for Large-scale Recommender Systems</span>
            <span class="post-date" title="2023-10-11 20:43:00">2023/10/11</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2023/09/21/Say%20Good%20Night%20To%20Insomnia/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Say Good Night To Insomnia">Say Good Night To Insomnia</span>
            <span class="post-date" title="2023-09-21 20:43:00">2023/09/21</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/09/20/Scenario-Adaptive%20Feature%20Interaction%20for%20Click-Through%20Rate%20Prediction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Scenario-Adaptive Feature Interaction for Click-Through Rate Prediction">Scenario-Adaptive Feature Interaction for Click-Through Rate Prediction</span>
            <span class="post-date" title="2023-09-20 20:43:00">2023/09/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/08/20/Gini%20Coefficient%20%E5%9F%BA%E5%B0%BC%E7%B3%BB%E6%95%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Gini Coefficient 基尼系数">Gini Coefficient 基尼系数</span>
            <span class="post-date" title="2023-08-20 20:08:00">2023/08/20</span>
        </a>
        
        
        <a  class="All AI "
           href="/2023/08/20/Pairwise%20%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Pairwise 损失函数计算">Pairwise 损失函数计算</span>
            <span class="post-date" title="2023-08-20 20:08:00">2023/08/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/08/13/A%20Simple%20Framework%20for%20Contrastive%20Learning%20of%20Visual%20Representations/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="A Simple Framework for Contrastive Learning of Visual Representations">A Simple Framework for Contrastive Learning of Visual Representations</span>
            <span class="post-date" title="2023-08-13 20:43:00">2023/08/13</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/07/20/Delving%20into%20Deep%20Imbalanced%20Regression/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Delving into Deep Imbalanced Regression">Delving into Deep Imbalanced Regression</span>
            <span class="post-date" title="2023-07-20 20:43:00">2023/07/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/07/18/CASPR:%20Customer%20Activity%20Sequence-based%20Prediction%20and%20Representation/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CASPR Customer Activity Sequence-based Prediction and Representation">CASPR Customer Activity Sequence-based Prediction and Representation</span>
            <span class="post-date" title="2023-07-18 20:00:00">2023/07/18</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/07/13/DCN%20V2%20Improved%20Deep%20&%20Cross%20Network%20and%20Practical%20Lessons%20for%20Web-scale%20Learning%20to%20Rank%20Systems/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DCN V2 Improved Deep &amp; Cross Network and Practical Lessons for Web-scale Learning to Rank Systems">DCN V2 Improved Deep &amp; Cross Network and Practical Lessons for Web-scale Learning to Rank Systems</span>
            <span class="post-date" title="2023-07-13 20:00:00">2023/07/13</span>
        </a>
        
        
        <a  class="All AI "
           href="/2023/07/05/Learning%20to%20Rank%20From%20Pairwise%20Approach%20to%20Listwise%20Approach/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Learning to Rank From Pairwise Approach to Listwise Approach">Learning to Rank From Pairwise Approach to Listwise Approach</span>
            <span class="post-date" title="2023-07-05 20:08:00">2023/07/05</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/07/03/Billion-user%20Customer%20Lifetime%20Value%20Prediction%20An%20Industrial-scale%20Solution%20from%20Kuaishou/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Billion-user Customer Lifetime Value Prediction An Industrial-scale Solution from Kuaishou">Billion-user Customer Lifetime Value Prediction An Industrial-scale Solution from Kuaishou</span>
            <span class="post-date" title="2023-07-03 20:00:00">2023/07/03</span>
        </a>
        
        
        <a  class="All AI "
           href="/2023/06/29/Ord2Seq%20Regarding%20Ordinal%20Regression%20as%20Label%20Sequence%20Prediction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Ord2Seq Regarding Ordinal Regression as Label Sequence Prediction">Ord2Seq Regarding Ordinal Regression as Label Sequence Prediction</span>
            <span class="post-date" title="2023-06-29 20:08:00">2023/06/29</span>
        </a>
        
        
        <a  class="All AI "
           href="/2023/06/21/Selective-Supervised%20Contrastive%20Learning%20with%20Noisy%20Labels/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Selective-Supervised Contrastive Learning with Noisy Labels">Selective-Supervised Contrastive Learning with Noisy Labels</span>
            <span class="post-date" title="2023-06-21 20:08:00">2023/06/21</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/06/20/Contrastive%20Multi-view%20Framework%20for%20Customer%20Lifetime%20Value%20Prediction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Contrastive Multi-view Framework for Customer Lifetime Value Prediction">Contrastive Multi-view Framework for Customer Lifetime Value Prediction</span>
            <span class="post-date" title="2023-06-20 20:43:00">2023/06/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/06/18/Ads_Target%20CPX%20v.s.%20Max%20Return/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Ads_Target CPX v.s. Max Return">Ads_Target CPX v.s. Max Return</span>
            <span class="post-date" title="2023-06-18 00:11:10">2023/06/18</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/06/18/Ads_%E9%A2%84%E6%9C%9F%E8%8A%B1%E8%B4%B9%E4%B8%8E%E5%90%8E%E9%AA%8C%E9%A2%84%E6%9C%9F%E8%8A%B1%E8%B4%B9/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Ads_预期花费与后验预期花费">Ads_预期花费与后验预期花费</span>
            <span class="post-date" title="2023-06-18 00:10:10">2023/06/18</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/06/15/MAE%20v.s.%20MSE%20%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%E6%AF%94%E8%BE%83/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="MAE v.s. MSE 损失函数比较">MAE v.s. MSE 损失函数比较</span>
            <span class="post-date" title="2023-06-15 20:43:00">2023/06/15</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/06/13/A%20Deep%20Probabilistic%20Model%20For%20Customer%20Lifetime%20Value%20Prediction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="A Deep Probabilistic Model For Customer Lifetime Value Prediction">A Deep Probabilistic Model For Customer Lifetime Value Prediction</span>
            <span class="post-date" title="2023-06-13 20:43:00">2023/06/13</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2023/05/30/Jen-Hsun%20Huang%20Stanford%20student%20and%20Entrpreneur,%20co-founder%20and%20CEO%20of%20NVIDIA/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Jen-Hsun Huang Stanford student and Entrpreneur, co-founder and CEO of NVIDIA">Jen-Hsun Huang Stanford student and Entrpreneur, co-founder and CEO of NVIDIA</span>
            <span class="post-date" title="2023-05-30 20:43:00">2023/05/30</span>
        </a>
        
        
        <a  class="All Rethinking "
           href="/2023/05/20/2022%20Annual%20Summary/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="2022 Annual Summary">2022 Annual Summary</span>
            <span class="post-date" title="2023-05-20 20:00:00">2023/05/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/05/12/Contrastive%20Learning%20for%20Conversion%20Rate%20Prediction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Contrastive Learning for Conversion Rate Prediction">Contrastive Learning for Conversion Rate Prediction</span>
            <span class="post-date" title="2023-05-12 20:43:00">2023/05/12</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2023/01/20/Follow%20the%20Prophet%20Accurate%20Online%20Conversion%20Rate%20Prediction%20in%20the%20Face%20of%20Delayed%20Feedback/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Follow the Prophet Accurate Online Conversion Rate Prediction in the Face of Delayed Feedback">Follow the Prophet Accurate Online Conversion Rate Prediction in the Face of Delayed Feedback</span>
            <span class="post-date" title="2023-01-20 20:08:00">2023/01/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2022/09/20/Tree%20based%20Progressive%20Regression%20Model%20for%20Watch-Time%20Prediction%20in%20Short-video%20Recommendation/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Tree based Progressive Regression Model for Watch-Time Prediction in Short-video Recommendation">Tree based Progressive Regression Model for Watch-Time Prediction in Short-video Recommendation</span>
            <span class="post-date" title="2022-09-20 20:08:00">2022/09/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2022/08/12/Field-aware%20Calibration%20A%20Simple%20and%20Empirically%20Strong%20Method%20for%20Reliable%20Probabilistic%20Predictions/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Field-aware Calibration A Simple and Empirically Strong Method for Reliable Probabilistic Predictions">Field-aware Calibration A Simple and Empirically Strong Method for Reliable Probabilistic Predictions</span>
            <span class="post-date" title="2022-08-12 20:43:00">2022/08/12</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2022/06/03/A%20Collection%20of%20High-Quality%20Blog/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="A Collection of High-Quality Blog">A Collection of High-Quality Blog</span>
            <span class="post-date" title="2022-06-03 20:28:00">2022/06/03</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2022/05/21/TabTransformer%20Tabular%20Data%20Modeling%20Using%20Contextual%20Embeddings/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="TabTransformer Tabular Data Modeling Using Contextual Embeddings">TabTransformer Tabular Data Modeling Using Contextual Embeddings</span>
            <span class="post-date" title="2022-05-21 20:43:00">2022/05/21</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2022/05/20/FinalMLP:%20An%20Enhanced%20Two-Stream%20MLP%20Model%20for%20CTR%20Prediction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="FinalMLP An Enhanced Two-Stream MLP Model for CTR Prediction">FinalMLP An Enhanced Two-Stream MLP Model for CTR Prediction</span>
            <span class="post-date" title="2022-05-20 20:43:00">2022/05/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2022/05/15/H&M%20Recommendation%20Competition%20Top1%20%E6%96%B9%E6%A1%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="H&amp;M Recommendation Competition Top1 方案">H&amp;M Recommendation Competition Top1 方案</span>
            <span class="post-date" title="2022-05-15 23:55:00">2022/05/15</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2022/03/20/Deep%20Interest%20Highlight%20Network%20for%20Click-Through%20Rate%20Prediction%20in%20Trigger-Induced%20Recommendation/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Deep Interest Highlight Network for Click-Through Rate Prediction in Trigger-Induced Recommendation">Deep Interest Highlight Network for Click-Through Rate Prediction in Trigger-Induced Recommendation</span>
            <span class="post-date" title="2022-03-20 22:00:00">2022/03/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2022/03/20/Progressive%20Layered%20Extraction%20(PLE)%20A%20Novel%20Multi-Task%20Learning%20(MTL)%20Model%20for%20Personalized%20Recommendations/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Progressive Layered Extraction (PLE) A Novel Multi-Task Learning (MTL) Model for Personalized Recommendations">Progressive Layered Extraction (PLE) A Novel Multi-Task Learning (MTL) Model for Personalized Recommendations</span>
            <span class="post-date" title="2022-03-20 20:08:00">2022/03/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2022/03/12/Mechanism%20Design%20%E6%9C%BA%E5%88%B6%E8%AE%BE%E8%AE%A1_1_Learning-based%20Mechanism/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Mechanism Design 机制设计_1_Learning-based Mechanism">Mechanism Design 机制设计_1_Learning-based Mechanism</span>
            <span class="post-date" title="2022-03-12 23:00:00">2022/03/12</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2022/02/20/Mechanism%20Design%20%E6%9C%BA%E5%88%B6%E8%AE%BE%E8%AE%A1_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Mechanism Design 机制设计_0_overview">Mechanism Design 机制设计_0_overview</span>
            <span class="post-date" title="2022-02-20 20:00:00">2022/02/20</span>
        </a>
        
        
        <a  class="All Rethinking "
           href="/2022/02/07/2021%20Annual%20Summary/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="2021 Annual Summary">2021 Annual Summary</span>
            <span class="post-date" title="2022-02-07 12:11:00">2022/02/07</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2021/11/11/Cybernetics%20and%20Society%20%E6%8E%A7%E5%88%B6%E8%AE%BA%E4%B8%8E%E7%A4%BE%E4%BC%9A/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Cybernetics and Society 控制论与社会">Cybernetics and Society 控制论与社会</span>
            <span class="post-date" title="2021-11-11 21:00:00">2021/11/11</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2021/09/10/Bias%20and%20Debias%20in%20Recommender%20System%20%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%20bias%20%E5%92%8C%20debias/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Bias and Debias in Recommender System 推荐系统中的 bias 和 debias">Bias and Debias in Recommender System 推荐系统中的 bias 和 debias</span>
            <span class="post-date" title="2021-09-10 21:00:00">2021/09/10</span>
        </a>
        
        
        <a  class="All AI "
           href="/2021/08/11/Supervised%20Contrastive%20Learning/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Supervised Contrastive Learning">Supervised Contrastive Learning</span>
            <span class="post-date" title="2021-08-11 20:43:00">2021/08/11</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2021/06/20/Multi-Task%20Learning%20Using%20Uncertainty%20to%20Weigh%20Losses%20for%20Scene%20Geometry%20and%20Semantics/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Multi-Task Learning Using Uncertainty to Weigh Losses for Scene Geometry and Semantics">Multi-Task Learning Using Uncertainty to Weigh Losses for Scene Geometry and Semantics</span>
            <span class="post-date" title="2021-06-20 20:08:00">2021/06/20</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2021/05/20/Causal%20Inference%20%E5%9B%A0%E6%9E%9C%E6%8E%A8%E6%96%AD/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Causal Inference 因果推断">Causal Inference 因果推断</span>
            <span class="post-date" title="2021-05-20 20:00:00">2021/05/20</span>
        </a>
        
        
        <a  class="All Rethinking "
           href="/2020/12/31/2020%20Annual%20Summary/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="2020 Annual Summary">2020 Annual Summary</span>
            <span class="post-date" title="2020-12-31 23:11:00">2020/12/31</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2020/12/20/Shoe%20Dog%20%E9%9E%8B%E7%8B%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Shoe Dog 鞋狗">Shoe Dog 鞋狗</span>
            <span class="post-date" title="2020-12-20 18:53:00">2020/12/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2020/11/08/The%20Essence%20of%20RecSys%20%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E7%B2%BE%E8%A6%81/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="The Essence of RecSys 推荐系统精要">The Essence of RecSys 推荐系统精要</span>
            <span class="post-date" title="2020-11-08 11:56:00">2020/11/08</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/10/01/Hexo%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%80%BB%E7%BB%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hexo 博客搭建总结">Hexo 博客搭建总结</span>
            <span class="post-date" title="2020-10-01 20:11:00">2020/10/01</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_0_1_cpp%20%E8%AE%BE%E8%AE%A1%E5%93%B2%E5%AD%A6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_0_1_cpp 设计哲学">cpp_0_1_cpp 设计哲学</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_0_1_vscode%20%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_0_1_vscode 环境配置">cpp_0_1_vscode 环境配置</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_0_2_%E5%A4%B4%E6%96%87%E4%BB%B6%20header%20file/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_0_2_头文件 headerfile">cpp_0_2_头文件 headerfile</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_0_3_%E8%B0%B7%E6%AD%8C%20C++%20%E7%BC%96%E7%A8%8B%E9%A3%8E%E6%A0%BC/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_0_3_谷歌 C++ 编程风格">cpp_0_3_谷歌 C++ 编程风格</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_1_1_%E5%B7%A6%E5%80%BC%E5%92%8C%E5%8F%B3%E5%80%BC/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_1_1_左值和右值">cpp_1_1_左值和右值</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_1_2_%E5%B7%A6%E5%80%BC%E5%BC%95%E7%94%A8%20Lvalue%20reference/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_1_2_左值引用 Lvalue reference">cpp_1_2_左值引用 Lvalue reference</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_1_3_%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8%20Rvalue%20reference/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_1_3_右值引用 Rvalue reference">cpp_1_3_右值引用 Rvalue reference</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_2_1_%E6%8C%87%E9%92%88%20Pointer_1_%E5%9C%B0%E5%9D%80%E5%92%8C%E6%8C%87%E9%92%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_2_1_指针 Pointer_1_地址和指针">cpp_2_1_指针 Pointer_1_地址和指针</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_2_2_%E6%8C%87%E9%92%88%20Pointer_2_%E7%A9%BA%E6%8C%87%E9%92%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_2_2_指针 Pointer_2_空指针">cpp_2_2_指针 Pointer_2_空指针</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_2_3_%E6%8C%87%E9%92%88%20Pointer_3_const%20%E4%B8%8E%E6%8C%87%E9%92%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_2_3_指针 Pointer_3_const 与指针">cpp_2_3_指针 Pointer_3_const 与指针</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_2_4_%E6%8C%87%E9%92%88%20Pointer_4_%E4%BC%A0%E5%9C%B0%E5%9D%80%20Pass%20by%20address/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_2_4_指针 Pointer_4_传地址 Pass by address">cpp_2_4_指针 Pointer_4_传地址 Pass by address</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_2_6_%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88_1_shared_ptr/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_2_6_智能指针_1_shared_ptr">cpp_2_6_智能指针_1_shared_ptr</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_2_5_%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88_0_%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_2_5_智能指针_0_设计思想">cpp_2_5_智能指针_0_设计思想</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_3_0_constexpr%20%E5%85%B3%E9%94%AE%E5%AD%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_3_0_constexpr关键字">cpp_3_0_constexpr关键字</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_2_7_%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88_2_unique_ptr/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_2_7_智能指针_2_unique_ptr">cpp_2_7_智能指针_2_unique_ptr</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_3_1_const%20%E5%85%B3%E9%94%AE%E5%AD%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_3_1_const 关键字">cpp_3_1_const 关键字</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_5_1_%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_5_1_面向对象_0_overview">cpp_5_1_面向对象_0_overview</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_3_2_Lambda%20%E8%A1%A8%E8%BE%BE%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_3_2_Lambda 表达式">cpp_3_2_Lambda 表达式</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_5_2_%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1_1_%E7%B1%BB%E5%92%8C%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_5_2_面向对象_1_类和成员函数">cpp_5_2_面向对象_1_类和成员函数</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_5_3_%E5%A4%9A%E6%80%81_0_%E8%99%9A%E5%87%BD%E6%95%B0%20Virtual%20Functions/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_5_3_多态_0_虚函数 Virtual Functions">cpp_5_3_多态_0_虚函数 Virtual Functions</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/09/10/cpp_6_0_%E6%A8%A1%E6%9D%BF%20template/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cpp_6_0_模板 template">cpp_6_0_模板 template</span>
            <span class="post-date" title="2020-09-10 00:00:00">2020/09/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/08/20/Python_%E5%A4%9A%E8%BF%9B%E7%A8%8B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Python_多进程">Python_多进程</span>
            <span class="post-date" title="2020-08-20 20:08:00">2020/08/20</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2020/08/15/%E6%B7%B1%E5%BA%A6%E7%82%B9%E5%87%BB%E7%8E%87%E9%A2%84%E4%BC%B0%E6%A8%A1%E5%9E%8B%E4%B8%AD%E7%9A%84%E7%89%B9%E5%BE%81%E4%BA%A4%E5%8F%89/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="深度点击率预估模型中的特征交叉">深度点击率预估模型中的特征交叉</span>
            <span class="post-date" title="2020-08-15 20:11:00">2020/08/15</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2020/07/18/Leetcode_hot_100%20%E6%80%BB%E7%BB%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Leetcode_hot_100 总结">Leetcode_hot_100 总结</span>
            <span class="post-date" title="2020-07-18 22:56:00">2020/07/18</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2020/04/13/Status%20as%20a%20Service%20%E5%9C%B0%E4%BD%8D%E5%8D%B3%E6%9C%8D%E5%8A%A1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Status as a Service 地位即服务">Status as a Service 地位即服务</span>
            <span class="post-date" title="2020-04-13 20:13:00">2020/04/13</span>
        </a>
        
        
        <a  class="All AI "
           href="/2020/04/04/Faiss%20%E5%90%91%E9%87%8F%E6%A3%80%E7%B4%A2%E5%BA%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Faiss 向量检索库">Faiss 向量检索库</span>
            <span class="post-date" title="2020-04-04 20:11:00">2020/04/04</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2020/03/22/%E7%8B%BC%E4%BA%BA%E6%9D%80%E5%A6%82%E4%BD%95%E8%87%B4%E8%83%9C/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="狼人杀如何致胜">狼人杀如何致胜</span>
            <span class="post-date" title="2020-03-22 02:12:57">2020/03/22</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2020/02/18/David%20Stern,%20who%20turned%20NBA%20into%20powerhouse/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="David Stern, who turned NBA into powerhouse">David Stern, who turned NBA into powerhouse</span>
            <span class="post-date" title="2020-02-18 22:56:00">2020/02/18</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/02/18/Linux%20%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E6%80%BB%E7%BB%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Linux 常用命令总结">Linux 常用命令总结</span>
            <span class="post-date" title="2020-02-18 22:56:00">2020/02/18</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/02/13/Tensorflow%20API%20%E6%80%BB%E7%BB%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Tensorflow API 总结">Tensorflow API 总结</span>
            <span class="post-date" title="2020-02-13 22:56:00">2020/02/13</span>
        </a>
        
        
        <a  class="All AI "
           href="/2020/02/03/Transformer/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Transformer">Transformer</span>
            <span class="post-date" title="2020-02-03 11:56:00">2020/02/03</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2020/01/31/G&R%20Blog%20Release%20Regulation/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="G&amp;R Blog Release Regulation">G&amp;R Blog Release Regulation</span>
            <span class="post-date" title="2020-01-31 20:01:00">2020/01/31</span>
        </a>
        
        
        <a  class="All AI "
           href="/2020/01/11/Tricks%20in%20Data%20Mining%20Competitions%20%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E6%AF%94%E8%B5%9B%E6%8A%80%E5%B7%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Tricks in Data Mining Competitions 数据挖掘比赛技巧">Tricks in Data Mining Competitions 数据挖掘比赛技巧</span>
            <span class="post-date" title="2020-01-11 20:11:00">2020/01/11</span>
        </a>
        
        
        <a  class="All AI "
           href="/2020/01/11/Word2Vec/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Word2Vec">Word2Vec</span>
            <span class="post-date" title="2020-01-11 20:11:00">2020/01/11</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2020/01/11/Yoshua%20Bengio%20%E5%AF%B9%20ML%20%E7%A0%94%E7%A9%B6%E8%80%85%E7%9A%84%E5%BB%BA%E8%AE%AE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Yoshua Bengio 对 ML 研究者的建议">Yoshua Bengio 对 ML 研究者的建议</span>
            <span class="post-date" title="2020-01-11 20:11:00">2020/01/11</span>
        </a>
        
        
        <a  class="All Rethinking "
           href="/2019/12/31/2019%20Annual%20Summary/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="2019 Annual Summary">2019 Annual Summary</span>
            <span class="post-date" title="2019-12-31 15:11:00">2019/12/31</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2019/12/11/Data%20Analysis%20Tutorial:(Part%20I)/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Data Analysis Tutorial:(Part I)">Data Analysis Tutorial:(Part I)</span>
            <span class="post-date" title="2019-12-11 20:11:00">2019/12/11</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2019/11/03/Marketing%20Management%20%E8%90%A5%E9%94%80%E7%AE%A1%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Marketing Management 营销管理">Marketing Management 营销管理</span>
            <span class="post-date" title="2019-11-03 13:03:00">2019/11/03</span>
        </a>
        
        
        <a  class="All Reading "
           href="/2019/10/01/Interview%20record%20of%20ML%20intern%20in%202019/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Interview record of ML intern in 2019">Interview record of ML intern in 2019</span>
            <span class="post-date" title="2019-10-01 12:12:57">2019/10/01</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2019/05/01/Errors%20Archives%20%E6%8A%A5%E9%94%99%E5%BD%92%E6%A1%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Errors Archives 报错归档">Errors Archives 报错归档</span>
            <span class="post-date" title="2019-05-01 13:03:00">2019/05/01</span>
        </a>
        
        
        <a  class="All Ads_RecSys "
           href="/2019/03/20/Modeling%20Task%20Relationships%20in%20Multi-task%20Learning%20with%20Multi-gate%20Mixture-of-Experts/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Modeling Task Relationships in Multi-task Learning with Multi-gate Mixture-of-Experts">Modeling Task Relationships in Multi-task Learning with Multi-gate Mixture-of-Experts</span>
            <span class="post-date" title="2019-03-20 20:43:00">2019/03/20</span>
        </a>
        
        
        <a  class="All Rethinking "
           href="/2018/12/31/2018%20Annual%20Summary/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="2018 Annual Summary">2018 Annual Summary</span>
            <span class="post-date" title="2018-12-31 20:17:00">2018/12/31</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/DivideConquer_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DivideConquer_0_overview">DivideConquer_0_overview</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/Hash_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hash_0_overview">Hash_0_overview</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/Heap_1_application/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Heap_1_application">Heap_1_application</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/IntervalProblem_%E5%8C%BA%E9%97%B4%E9%97%AE%E9%A2%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="IntervalProblem_区间问题">IntervalProblem_区间问题</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2018/06/10/LinkedList_%E9%93%BE%E8%A1%A8%E6%93%8D%E4%BD%9C/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="LinkedList_链表操作">LinkedList_链表操作</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/Trie_%E5%89%8D%E7%BC%80%E6%A0%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Trie_前缀树">Trie_前缀树</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/TwoPointers_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="TwoPointers_0_overview">TwoPointers_0_overview</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/TwoPointers_1_%E5%BF%AB%E6%85%A2%E6%8C%87%E9%92%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="TwoPointers_1_快慢指针">TwoPointers_1_快慢指针</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/TwoPointers_2_%E5%B7%A6%E5%8F%B3%E6%8C%87%E9%92%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="TwoPointers_2_左右指针">TwoPointers_2_左右指针</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/TwoPointers_3_%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="TwoPointers_3_滑动窗口">TwoPointers_3_滑动窗口</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/TwoPointers_4_Rabin_Karp/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="TwoPointers_4_Rabin_Karp">TwoPointers_4_Rabin_Karp</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/TwoPointers_5_%E9%93%BE%E8%A1%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="TwoPointers_5_链表">TwoPointers_5_链表</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/TwoPointers_6_n%E6%95%B0%E4%B9%8B%E5%92%8C/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="TwoPointers_6_n数之和">TwoPointers_6_n数之和</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/TwoPointers_7_%E8%8D%B7%E5%85%B0%E5%9B%BD%E6%97%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="TwoPointers_7_荷兰国旗">TwoPointers_7_荷兰国旗</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/06/10/UnionFind_%E5%B9%B6%E6%9F%A5%E9%9B%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="UnionFind_并查集">UnionFind_并查集</span>
            <span class="post-date" title="2018-06-10 00:00:00">2018/06/10</span>
        </a>
        
        
        <a  class="All Coding "
           href="/2018/04/05/Git%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Git 使用指南">Git 使用指南</span>
            <span class="post-date" title="2018-04-05 22:56:00">2018/04/05</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/19/Stack_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Stack_0_overview">Stack_0_overview</span>
            <span class="post-date" title="2018-01-19 01:10:00">2018/01/19</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/19/Stack_1_%E5%8D%95%E8%B0%83%E6%A0%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Stack_1_单调栈">Stack_1_单调栈</span>
            <span class="post-date" title="2018-01-19 01:09:00">2018/01/19</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/19/Stack_2_%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%A7%A3%E7%A0%81/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Stack_2_表达式解码">Stack_2_表达式解码</span>
            <span class="post-date" title="2018-01-19 01:08:00">2018/01/19</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/19/Sort_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Sort_0_overview">Sort_0_overview</span>
            <span class="post-date" title="2018-01-19 00:10:00">2018/01/19</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/19/Sort_1_mergeSort_%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Sort_1_mergeSort_归并排序">Sort_1_mergeSort_归并排序</span>
            <span class="post-date" title="2018-01-19 00:09:01">2018/01/19</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/19/Sort_1_insertionSort_%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Sort_1_insertionSort_插入排序">Sort_1_insertionSort_插入排序</span>
            <span class="post-date" title="2018-01-19 00:09:00">2018/01/19</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/19/Sort_2_quickSort_%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Sort_2_quickSort_快速排序">Sort_2_quickSort_快速排序</span>
            <span class="post-date" title="2018-01-19 00:08:01">2018/01/19</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/19/Sort_2_Partition_%E5%88%92%E5%88%86%E7%AE%97%E6%B3%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Sort_2_Partition_划分算法">Sort_2_Partition_划分算法</span>
            <span class="post-date" title="2018-01-19 00:08:00">2018/01/19</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/19/Sort_3_heapSort_%E5%A0%86%E6%8E%92%E5%BA%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Sort_3_heapSort_堆排序">Sort_3_heapSort_堆排序</span>
            <span class="post-date" title="2018-01-19 00:07:00">2018/01/19</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/19/Sort_4_application_%E6%8E%92%E5%BA%8F%E9%A2%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Sort_4_application_排序题">Sort_4_application_排序题</span>
            <span class="post-date" title="2018-01-19 00:06:00">2018/01/19</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/07/Greedy_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Greedy_0_overview">Greedy_0_overview</span>
            <span class="post-date" title="2018-01-07 01:10:00">2018/01/07</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/07/Graph_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Graph_0_overview">Graph_0_overview</span>
            <span class="post-date" title="2018-01-07 00:10:00">2018/01/07</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/07/Graph_1_dfs_%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E9%81%8D%E5%8E%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Graph_1_dfs_深度优先遍历">Graph_1_dfs_深度优先遍历</span>
            <span class="post-date" title="2018-01-07 00:09:00">2018/01/07</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/07/Graph_2_bfs_%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E9%81%8D%E5%8E%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Graph_2_bfs_广度优先遍历">Graph_2_bfs_广度优先遍历</span>
            <span class="post-date" title="2018-01-07 00:08:00">2018/01/07</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/07/Graph_3_%E7%8E%AF%E6%A3%80%E6%B5%8B%E4%B8%8E%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Graph_3_环检测与拓扑排序">Graph_3_环检测与拓扑排序</span>
            <span class="post-date" title="2018-01-07 00:08:00">2018/01/07</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/07/Graph_4_%E5%B2%9B%E5%B1%BF%E9%97%AE%E9%A2%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Graph_4_岛屿问题">Graph_4_岛屿问题</span>
            <span class="post-date" title="2018-01-07 00:06:00">2018/01/07</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/07/Graph_5_Kruskal/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Graph_5_Kruskal">Graph_5_Kruskal</span>
            <span class="post-date" title="2018-01-07 00:05:00">2018/01/07</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/07/Graph_6_Prim/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Graph_6_Prim">Graph_6_Prim</span>
            <span class="post-date" title="2018-01-07 00:04:00">2018/01/07</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/07/Graph_7_Dijstra/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Graph_7_Dijstra">Graph_7_Dijstra</span>
            <span class="post-date" title="2018-01-07 00:03:00">2018/01/07</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/04/DP_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DP_0_overview">DP_0_overview</span>
            <span class="post-date" title="2018-01-04 01:10:00">2018/01/04</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/04/DP_1_%E5%A4%87%E5%BF%98%E5%BD%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DP_1_备忘录">DP_1_备忘录</span>
            <span class="post-date" title="2018-01-04 01:09:00">2018/01/04</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/04/DP_2_%E6%9C%80%E5%80%BC%E9%97%AE%E9%A2%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DP_2_最值问题">DP_2_最值问题</span>
            <span class="post-date" title="2018-01-04 01:08:00">2018/01/04</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/04/DP_3_%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E8%BF%98%E6%98%AF%E8%87%AA%E5%BA%95%E5%90%91%E4%B8%8A/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DP_3_自顶向下还是自底向上">DP_3_自顶向下还是自底向上</span>
            <span class="post-date" title="2018-01-04 01:07:01">2018/01/04</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/04/DP_3_%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DP_3_背包问题">DP_3_背包问题</span>
            <span class="post-date" title="2018-01-04 01:07:00">2018/01/04</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/04/DP_4_%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DP_4_买卖股票">DP_4_买卖股票</span>
            <span class="post-date" title="2018-01-04 01:06:00">2018/01/04</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/04/DP_5_%E6%89%93%E5%AE%B6%E5%8A%AB%E8%88%8D/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DP_5_打家劫舍">DP_5_打家劫舍</span>
            <span class="post-date" title="2018-01-04 01:05:00">2018/01/04</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/04/DP_6_%E9%AB%98%E7%BB%B4%20dp/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DP_6_高维 dp">DP_6_高维 dp</span>
            <span class="post-date" title="2018-01-04 01:04:00">2018/01/04</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/03/cache_LFU/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cache_LFU">cache_LFU</span>
            <span class="post-date" title="2018-01-03 01:10:00">2018/01/03</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/03/cache_LRU/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cache_LRU">cache_LRU</span>
            <span class="post-date" title="2018-01-03 00:10:00">2018/01/03</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/Bit_%E4%BD%8D%E8%BF%90%E7%AE%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Bit_位运算">Bit_位运算</span>
            <span class="post-date" title="2018-01-02 04:00:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/Bipartite_%E4%BA%8C%E5%88%86%E5%9B%BE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Bipartite_二分图">Bipartite_二分图</span>
            <span class="post-date" title="2018-01-02 03:00:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_0_overview">BinaryTree_0_overview</span>
            <span class="post-date" title="2018-01-02 02:10:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_1_%E5%88%86%E8%A7%A3%E9%97%AE%E9%A2%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_1_分解问题">BinaryTree_1_分解问题</span>
            <span class="post-date" title="2018-01-02 02:09:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_2_%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_2_路径问题">BinaryTree_2_路径问题</span>
            <span class="post-date" title="2018-01-02 02:08:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_3_%E8%BF%AD%E4%BB%A3%E9%81%8D%E5%8E%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_3_迭代遍历">BinaryTree_3_迭代遍历</span>
            <span class="post-date" title="2018-01-02 02:07:01">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_3_%E5%B1%82%E5%BA%8F%E9%81%8D%E5%8E%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_3_层序遍历">BinaryTree_3_层序遍历</span>
            <span class="post-date" title="2018-01-02 02:07:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_4_%E6%9E%84%E9%80%A0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_4_构造">BinaryTree_4_构造</span>
            <span class="post-date" title="2018-01-02 02:06:01">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_4_%E4%BA%8C%E5%8F%89%E6%A0%91%E5%92%8C%E9%93%BE%E8%A1%A8%E7%9A%84%E4%BA%92%E7%9B%B8%E8%BD%AC%E5%8C%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_4_二叉树和链表的互相转化">BinaryTree_4_二叉树和链表的互相转化</span>
            <span class="post-date" title="2018-01-02 02:06:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_5_%E5%BA%8F%E5%88%97%E5%8C%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_4_二叉树和链表的互相转化">BinaryTree_4_二叉树和链表的互相转化</span>
            <span class="post-date" title="2018-01-02 02:05:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_6_BST_%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_6_BST_特性">BinaryTree_6_BST_特性</span>
            <span class="post-date" title="2018-01-02 02:04:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_7_BST_%E6%9F%A5%E6%89%BE%E6%8F%92%E5%85%A5%E5%88%A0%E9%99%A4%E9%AA%8C%E8%AF%81/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_7_BST_查找插入删除验证">BinaryTree_7_BST_查找插入删除验证</span>
            <span class="post-date" title="2018-01-02 02:03:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinaryTree_8_BST_%E6%9E%84%E9%80%A0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinaryTree_8_BST_构造">BinaryTree_8_BST_构造</span>
            <span class="post-date" title="2018-01-02 02:02:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinarySearch_0_%E9%97%AD%E5%8C%BA%E9%97%B4%E6%90%9C%E7%B4%A2%E5%92%8C%E5%B7%A6%E9%97%AD%E5%8F%B3%E5%BC%80%E6%90%9C%E7%B4%A2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinarySearch_0_闭区间搜索和左闭右开搜索">BinarySearch_0_闭区间搜索和左闭右开搜索</span>
            <span class="post-date" title="2018-01-02 01:10:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinarySearch_1_%E5%8D%95%E8%B0%83%E7%BB%93%E6%9E%84%E4%B8%8B%E4%BA%8C%E5%88%86%E6%90%9C%E7%B4%A2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinarySearch_1_单调结构下二分搜索">BinarySearch_1_单调结构下二分搜索</span>
            <span class="post-date" title="2018-01-02 01:09:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinarySearch_2_%E6%97%8B%E8%BD%AC%E6%95%B0%E7%BB%84%E4%BA%8C%E5%88%86%E6%90%9C%E7%B4%A2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinarySearch_2_旋转数组二分搜索">BinarySearch_2_旋转数组二分搜索</span>
            <span class="post-date" title="2018-01-02 01:08:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/BinarySearch_3_%E5%8D%95%E8%B0%83%E6%80%A7%E5%BA%94%E7%94%A8%E9%97%AE%E9%A2%98%E7%9A%84%E4%BA%8C%E5%88%86%E6%90%9C%E7%B4%A2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="BinarySearch_3_单调性应用问题的二分搜索">BinarySearch_3_单调性应用问题的二分搜索</span>
            <span class="post-date" title="2018-01-02 01:07:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/Backtrack_0_overview/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Backtrack_0_overview">Backtrack_0_overview</span>
            <span class="post-date" title="2018-01-02 00:10:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/Backtrack_1_N%E7%9A%87%E5%90%8E%E5%92%8C%E8%A7%A3%E6%95%B0%E7%8B%AC/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Backtrack_1_N皇后和解数独">Backtrack_1_N皇后和解数独</span>
            <span class="post-date" title="2018-01-02 00:09:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/02/Backtrack_2_%E7%94%9F%E6%88%90%E6%8E%92%E5%88%97%E7%BB%84%E5%90%88%E5%AD%90%E9%9B%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Backtrack_2_生成排列组合子集">Backtrack_2_生成排列组合子集</span>
            <span class="post-date" title="2018-01-02 00:08:00">2018/01/02</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/01/Array_1_0_%E5%89%8D%E7%BC%80%E5%92%8C%E6%95%B0%E7%BB%84/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Array_1_0_前缀和数组与差分数组">Array_1_0_前缀和数组与差分数组</span>
            <span class="post-date" title="2018-01-01 00:10:10">2018/01/01</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/01/Array_1_1_%E5%B7%AE%E5%88%86%E6%95%B0%E7%BB%84/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Array_1_差分数组">Array_1_差分数组</span>
            <span class="post-date" title="2018-01-01 00:09:10">2018/01/01</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/01/Array_2_%E8%8A%B1%E5%BC%8F%E6%90%9C%E7%B4%A2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Array_2_花式搜索">Array_2_花式搜索</span>
            <span class="post-date" title="2018-01-01 00:08:00">2018/01/01</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/01/Array_3_%E5%9B%BE%E5%83%8F%E7%BF%BB%E8%BD%AC/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Array_3_图像翻转">Array_3_图像翻转</span>
            <span class="post-date" title="2018-01-01 00:07:00">2018/01/01</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/01/Array_4_%E7%8E%AF%E5%BD%A2%E6%95%B0%E7%BB%84/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Array_4_环形数组">Array_4_环形数组</span>
            <span class="post-date" title="2018-01-01 00:06:00">2018/01/01</span>
        </a>
        
        
        <a  class="All Algorithm "
           href="/2018/01/01/Array_5_%E7%9F%A9%E9%98%B5%E6%93%8D%E4%BD%9C/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Array_5_矩阵操作">Array_5_矩阵操作</span>
            <span class="post-date" title="2018-01-01 00:05:00">2018/01/01</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-QLoRA finetune codegen350M" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">QLoRA finetune codegen350M</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="AI">AI</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2025-05-05 19:48:55'>2024-10-03 20:43</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:8k</span>
        
        
        
        <span class="top-comment" title="Jump to comment area">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#qlora-finetune-codegen350M"><span class="toc-text">qlora_finetune_codegen350M</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E8%B0%83%E6%95%B0%E6%8D%AE%E9%9B%86-python-python-code-instructions-18k-alpaca"><span class="toc-text">微调数据集: python python_code_instructions_18k_alpaca</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA-QLoRA-%E5%BE%AE%E8%B0%83-Pipeline"><span class="toc-text">搭建 QLoRA 微调 Pipeline</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E8%B0%83%E6%A8%A1%E5%9E%8B-Salesforce-codegen-350M-mono"><span class="toc-text">微调模型 Salesforce&#x2F;codegen-350M-mono</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89-prompt-instruction-%E6%A8%A1%E6%9D%BF"><span class="toc-text">定义 prompt instruction 模板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89-SFTTrainer"><span class="toc-text">定义 SFTTrainer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E8%B0%83%E6%95%88%E6%9E%9C%E8%AF%84%E4%BC%B0"><span class="toc-text">微调效果评估</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-text">Reference</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="qlora-finetune-codegen350M"><a href="#qlora-finetune-codegen350M" class="headerlink" title="qlora_finetune_codegen350M"></a>qlora_finetune_codegen350M</h2><p>1.采用 QLoRA 微调模型 Salesforce/codegen-350M-mono, 是个代码生成的模型, model_card: <a target="_blank" rel="noopener" href="https://huggingface.co/Salesforce/codegen-350M-mono">https://huggingface.co/Salesforce/codegen-350M-mono</a><br>2.微调数据集采用 iamtarun/python_code_instructions_18k_alpaca, dataset card: <a target="_blank" rel="noopener" href="https://huggingface.co/datasets/iamtarun/python_code_instructions_18k_alpaca">https://huggingface.co/datasets/iamtarun/python_code_instructions_18k_alpaca</a><br>3.如何配置 LoRA 微调的方式? 相比原有的微调多一个 LoRAConfig<br>4.微调效果评估: 对比 base_model 和 lora_merged_model 生成代码的质量, 看下微调是否带来生成质量的提升  </p>
<pre><code class="lang-python"># 配置环境
%pip install transformers datasets huggingface_hub accelerate bitsandbytes
%pip install trl peft loralib wandb evaluate scikit-learn
%pip install ipywidgets widgetsnbextension
</code></pre>
<pre><code>Looking in indexes: http://mirrors.aliyun.com/pypi/simple
Requirement already satisfied: transformers in /root/miniconda3/lib/python3.10/site-packages (4.51.3)
Requirement already satisfied: datasets in /root/miniconda3/lib/python3.10/site-packages (3.5.1)
Requirement already satisfied: huggingface_hub in /root/miniconda3/lib/python3.10/site-packages (0.30.2)
Requirement already satisfied: accelerate in /root/miniconda3/lib/python3.10/site-packages (1.6.0)
Requirement already satisfied: bitsandbytes in /root/miniconda3/lib/python3.10/site-packages (0.45.5)
Requirement already satisfied: regex!=2019.12.17 in /root/miniconda3/lib/python3.10/site-packages (from transformers) (2024.11.6)
Requirement already satisfied: numpy&gt;=1.17 in /root/miniconda3/lib/python3.10/site-packages (from transformers) (1.26.4)
Requirement already satisfied: pyyaml&gt;=5.1 in /root/miniconda3/lib/python3.10/site-packages (from transformers) (6.0.1)
Requirement already satisfied: packaging&gt;=20.0 in /root/miniconda3/lib/python3.10/site-packages (from transformers) (24.1)
Requirement already satisfied: filelock in /root/miniconda3/lib/python3.10/site-packages (from transformers) (3.14.0)
Requirement already satisfied: tokenizers&lt;0.22,&gt;=0.21 in /root/miniconda3/lib/python3.10/site-packages (from transformers) (0.21.1)
Requirement already satisfied: requests in /root/miniconda3/lib/python3.10/site-packages (from transformers) (2.32.3)
Requirement already satisfied: tqdm&gt;=4.27 in /root/miniconda3/lib/python3.10/site-packages (from transformers) (4.67.1)
Requirement already satisfied: safetensors&gt;=0.4.3 in /root/miniconda3/lib/python3.10/site-packages (from transformers) (0.5.3)
Requirement already satisfied: pyarrow&gt;=15.0.0 in /root/miniconda3/lib/python3.10/site-packages (from datasets) (20.0.0)
Requirement already satisfied: xxhash in /root/miniconda3/lib/python3.10/site-packages (from datasets) (3.5.0)
Requirement already satisfied: fsspec[http]&lt;=2025.3.0,&gt;=2023.1.0 in /root/miniconda3/lib/python3.10/site-packages (from datasets) (2024.6.0)
Requirement already satisfied: aiohttp in /root/miniconda3/lib/python3.10/site-packages (from datasets) (3.11.18)
Requirement already satisfied: dill&lt;0.3.9,&gt;=0.3.0 in /root/miniconda3/lib/python3.10/site-packages (from datasets) (0.3.8)
Requirement already satisfied: pandas in /root/miniconda3/lib/python3.10/site-packages (from datasets) (2.2.3)
Requirement already satisfied: multiprocess&lt;0.70.17 in /root/miniconda3/lib/python3.10/site-packages (from datasets) (0.70.16)
Requirement already satisfied: typing-extensions&gt;=3.7.4.3 in /root/miniconda3/lib/python3.10/site-packages (from huggingface_hub) (4.12.2)
Requirement already satisfied: psutil in /root/miniconda3/lib/python3.10/site-packages (from accelerate) (5.9.8)
Requirement already satisfied: torch&gt;=2.0.0 in /root/miniconda3/lib/python3.10/site-packages (from accelerate) (2.1.2+cu118)
Requirement already satisfied: frozenlist&gt;=1.1.1 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets) (1.6.0)
Requirement already satisfied: aiohappyeyeballs&gt;=2.3.0 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets) (2.6.1)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.17.0 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets) (1.20.0)
Requirement already satisfied: attrs&gt;=17.3.0 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets) (23.2.0)
Requirement already satisfied: async-timeout&lt;6.0,&gt;=4.0 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets) (5.0.1)
Requirement already satisfied: aiosignal&gt;=1.1.2 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets) (1.3.2)
Requirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets) (6.4.3)
Requirement already satisfied: propcache&gt;=0.2.0 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets) (0.3.1)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /root/miniconda3/lib/python3.10/site-packages (from requests-&gt;transformers) (1.26.13)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /root/miniconda3/lib/python3.10/site-packages (from requests-&gt;transformers) (2.0.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /root/miniconda3/lib/python3.10/site-packages (from requests-&gt;transformers) (3.4)
Requirement already satisfied: certifi&gt;=2017.4.17 in /root/miniconda3/lib/python3.10/site-packages (from requests-&gt;transformers) (2022.12.7)
Requirement already satisfied: triton==2.1.0 in /root/miniconda3/lib/python3.10/site-packages (from torch&gt;=2.0.0-&gt;accelerate) (2.1.0)
Requirement already satisfied: jinja2 in /root/miniconda3/lib/python3.10/site-packages (from torch&gt;=2.0.0-&gt;accelerate) (3.1.4)
Requirement already satisfied: sympy in /root/miniconda3/lib/python3.10/site-packages (from torch&gt;=2.0.0-&gt;accelerate) (1.12.1)
Requirement already satisfied: networkx in /root/miniconda3/lib/python3.10/site-packages (from torch&gt;=2.0.0-&gt;accelerate) (3.3)
Requirement already satisfied: pytz&gt;=2020.1 in /root/miniconda3/lib/python3.10/site-packages (from pandas-&gt;datasets) (2025.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /root/miniconda3/lib/python3.10/site-packages (from pandas-&gt;datasets) (2.9.0.post0)
Requirement already satisfied: tzdata&gt;=2022.7 in /root/miniconda3/lib/python3.10/site-packages (from pandas-&gt;datasets) (2025.2)
Requirement already satisfied: six&gt;=1.5 in /root/miniconda3/lib/python3.10/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas-&gt;datasets) (1.16.0)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /root/miniconda3/lib/python3.10/site-packages (from jinja2-&gt;torch&gt;=2.0.0-&gt;accelerate) (2.1.5)
Requirement already satisfied: mpmath&lt;1.4.0,&gt;=1.1.0 in /root/miniconda3/lib/python3.10/site-packages (from sympy-&gt;torch&gt;=2.0.0-&gt;accelerate) (1.3.0)
[33mWARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m[33m
[0mNote: you may need to restart the kernel to use updated packages.
Looking in indexes: http://mirrors.aliyun.com/pypi/simple
Requirement already satisfied: trl in /root/miniconda3/lib/python3.10/site-packages (0.17.0)
Requirement already satisfied: peft in /root/miniconda3/lib/python3.10/site-packages (0.15.2)
Requirement already satisfied: loralib in /root/miniconda3/lib/python3.10/site-packages (0.1.2)
Requirement already satisfied: wandb in /root/miniconda3/lib/python3.10/site-packages (0.19.10)
Requirement already satisfied: evaluate in /root/miniconda3/lib/python3.10/site-packages (0.4.3)
Requirement already satisfied: scikit-learn in /root/miniconda3/lib/python3.10/site-packages (1.6.1)
Requirement already satisfied: transformers&gt;=4.46.0 in /root/miniconda3/lib/python3.10/site-packages (from trl) (4.51.3)
Requirement already satisfied: accelerate&gt;=0.34.0 in /root/miniconda3/lib/python3.10/site-packages (from trl) (1.6.0)
Requirement already satisfied: datasets&gt;=3.0.0 in /root/miniconda3/lib/python3.10/site-packages (from trl) (3.5.1)
Requirement already satisfied: rich in /root/miniconda3/lib/python3.10/site-packages (from trl) (14.0.0)
Requirement already satisfied: packaging&gt;=20.0 in /root/miniconda3/lib/python3.10/site-packages (from peft) (24.1)
Requirement already satisfied: tqdm in /root/miniconda3/lib/python3.10/site-packages (from peft) (4.67.1)
Requirement already satisfied: torch&gt;=1.13.0 in /root/miniconda3/lib/python3.10/site-packages (from peft) (2.1.2+cu118)
Requirement already satisfied: safetensors in /root/miniconda3/lib/python3.10/site-packages (from peft) (0.5.3)
Requirement already satisfied: psutil in /root/miniconda3/lib/python3.10/site-packages (from peft) (5.9.8)
Requirement already satisfied: huggingface_hub&gt;=0.25.0 in /root/miniconda3/lib/python3.10/site-packages (from peft) (0.30.2)
Requirement already satisfied: pyyaml in /root/miniconda3/lib/python3.10/site-packages (from peft) (6.0.1)
Requirement already satisfied: numpy&gt;=1.17 in /root/miniconda3/lib/python3.10/site-packages (from peft) (1.26.4)
Requirement already satisfied: requests&lt;3,&gt;=2.0.0 in /root/miniconda3/lib/python3.10/site-packages (from wandb) (2.32.3)
Requirement already satisfied: platformdirs in /root/miniconda3/lib/python3.10/site-packages (from wandb) (4.2.2)
Requirement already satisfied: pydantic&lt;3 in /root/miniconda3/lib/python3.10/site-packages (from wandb) (2.11.4)
Requirement already satisfied: sentry-sdk&gt;=2.0.0 in /root/miniconda3/lib/python3.10/site-packages (from wandb) (2.27.0)
Requirement already satisfied: typing-extensions&lt;5,&gt;=4.4 in /root/miniconda3/lib/python3.10/site-packages (from wandb) (4.12.2)
Requirement already satisfied: docker-pycreds&gt;=0.4.0 in /root/miniconda3/lib/python3.10/site-packages (from wandb) (0.4.0)
Requirement already satisfied: click!=8.0.0,&gt;=7.1 in /root/miniconda3/lib/python3.10/site-packages (from wandb) (8.1.8)
Requirement already satisfied: protobuf!=4.21.0,!=5.28.0,&lt;7,&gt;=3.19.0 in /root/miniconda3/lib/python3.10/site-packages (from wandb) (4.25.3)
Requirement already satisfied: setproctitle in /root/miniconda3/lib/python3.10/site-packages (from wandb) (1.3.6)
Requirement already satisfied: gitpython!=3.1.29,&gt;=1.0.0 in /root/miniconda3/lib/python3.10/site-packages (from wandb) (3.1.44)
Requirement already satisfied: setuptools in /root/miniconda3/lib/python3.10/site-packages (from wandb) (65.5.0)
Requirement already satisfied: pandas in /root/miniconda3/lib/python3.10/site-packages (from evaluate) (2.2.3)
Requirement already satisfied: dill in /root/miniconda3/lib/python3.10/site-packages (from evaluate) (0.3.8)
Requirement already satisfied: xxhash in /root/miniconda3/lib/python3.10/site-packages (from evaluate) (3.5.0)
Requirement already satisfied: multiprocess in /root/miniconda3/lib/python3.10/site-packages (from evaluate) (0.70.16)
Requirement already satisfied: fsspec[http]&gt;=2021.05.0 in /root/miniconda3/lib/python3.10/site-packages (from evaluate) (2024.6.0)
Requirement already satisfied: threadpoolctl&gt;=3.1.0 in /root/miniconda3/lib/python3.10/site-packages (from scikit-learn) (3.6.0)
Requirement already satisfied: joblib&gt;=1.2.0 in /root/miniconda3/lib/python3.10/site-packages (from scikit-learn) (1.5.0)
Requirement already satisfied: scipy&gt;=1.6.0 in /root/miniconda3/lib/python3.10/site-packages (from scikit-learn) (1.15.2)
Requirement already satisfied: filelock in /root/miniconda3/lib/python3.10/site-packages (from datasets&gt;=3.0.0-&gt;trl) (3.14.0)
Requirement already satisfied: pyarrow&gt;=15.0.0 in /root/miniconda3/lib/python3.10/site-packages (from datasets&gt;=3.0.0-&gt;trl) (20.0.0)
Requirement already satisfied: aiohttp in /root/miniconda3/lib/python3.10/site-packages (from datasets&gt;=3.0.0-&gt;trl) (3.11.18)
Requirement already satisfied: six&gt;=1.4.0 in /root/miniconda3/lib/python3.10/site-packages (from docker-pycreds&gt;=0.4.0-&gt;wandb) (1.16.0)
Requirement already satisfied: gitdb&lt;5,&gt;=4.0.1 in /root/miniconda3/lib/python3.10/site-packages (from gitpython!=3.1.29,&gt;=1.0.0-&gt;wandb) (4.0.12)
Requirement already satisfied: pydantic-core==2.33.2 in /root/miniconda3/lib/python3.10/site-packages (from pydantic&lt;3-&gt;wandb) (2.33.2)
Requirement already satisfied: typing-inspection&gt;=0.4.0 in /root/miniconda3/lib/python3.10/site-packages (from pydantic&lt;3-&gt;wandb) (0.4.0)
Requirement already satisfied: annotated-types&gt;=0.6.0 in /root/miniconda3/lib/python3.10/site-packages (from pydantic&lt;3-&gt;wandb) (0.7.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /root/miniconda3/lib/python3.10/site-packages (from requests&lt;3,&gt;=2.0.0-&gt;wandb) (3.4)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /root/miniconda3/lib/python3.10/site-packages (from requests&lt;3,&gt;=2.0.0-&gt;wandb) (2.0.4)
Requirement already satisfied: certifi&gt;=2017.4.17 in /root/miniconda3/lib/python3.10/site-packages (from requests&lt;3,&gt;=2.0.0-&gt;wandb) (2022.12.7)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /root/miniconda3/lib/python3.10/site-packages (from requests&lt;3,&gt;=2.0.0-&gt;wandb) (1.26.13)
Requirement already satisfied: sympy in /root/miniconda3/lib/python3.10/site-packages (from torch&gt;=1.13.0-&gt;peft) (1.12.1)
Requirement already satisfied: jinja2 in /root/miniconda3/lib/python3.10/site-packages (from torch&gt;=1.13.0-&gt;peft) (3.1.4)
Requirement already satisfied: triton==2.1.0 in /root/miniconda3/lib/python3.10/site-packages (from torch&gt;=1.13.0-&gt;peft) (2.1.0)
Requirement already satisfied: networkx in /root/miniconda3/lib/python3.10/site-packages (from torch&gt;=1.13.0-&gt;peft) (3.3)
Requirement already satisfied: regex!=2019.12.17 in /root/miniconda3/lib/python3.10/site-packages (from transformers&gt;=4.46.0-&gt;trl) (2024.11.6)
Requirement already satisfied: tokenizers&lt;0.22,&gt;=0.21 in /root/miniconda3/lib/python3.10/site-packages (from transformers&gt;=4.46.0-&gt;trl) (0.21.1)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /root/miniconda3/lib/python3.10/site-packages (from pandas-&gt;evaluate) (2.9.0.post0)
Requirement already satisfied: tzdata&gt;=2022.7 in /root/miniconda3/lib/python3.10/site-packages (from pandas-&gt;evaluate) (2025.2)
Requirement already satisfied: pytz&gt;=2020.1 in /root/miniconda3/lib/python3.10/site-packages (from pandas-&gt;evaluate) (2025.2)
Requirement already satisfied: markdown-it-py&gt;=2.2.0 in /root/miniconda3/lib/python3.10/site-packages (from rich-&gt;trl) (3.0.0)
Requirement already satisfied: pygments&lt;3.0.0,&gt;=2.13.0 in /root/miniconda3/lib/python3.10/site-packages (from rich-&gt;trl) (2.18.0)
Requirement already satisfied: frozenlist&gt;=1.1.1 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets&gt;=3.0.0-&gt;trl) (1.6.0)
Requirement already satisfied: aiohappyeyeballs&gt;=2.3.0 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets&gt;=3.0.0-&gt;trl) (2.6.1)
Requirement already satisfied: attrs&gt;=17.3.0 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets&gt;=3.0.0-&gt;trl) (23.2.0)
Requirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets&gt;=3.0.0-&gt;trl) (6.4.3)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.17.0 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets&gt;=3.0.0-&gt;trl) (1.20.0)
Requirement already satisfied: aiosignal&gt;=1.1.2 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets&gt;=3.0.0-&gt;trl) (1.3.2)
Requirement already satisfied: async-timeout&lt;6.0,&gt;=4.0 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets&gt;=3.0.0-&gt;trl) (5.0.1)
Requirement already satisfied: propcache&gt;=0.2.0 in /root/miniconda3/lib/python3.10/site-packages (from aiohttp-&gt;datasets&gt;=3.0.0-&gt;trl) (0.3.1)
Requirement already satisfied: smmap&lt;6,&gt;=3.0.1 in /root/miniconda3/lib/python3.10/site-packages (from gitdb&lt;5,&gt;=4.0.1-&gt;gitpython!=3.1.29,&gt;=1.0.0-&gt;wandb) (5.0.2)
Requirement already satisfied: mdurl~=0.1 in /root/miniconda3/lib/python3.10/site-packages (from markdown-it-py&gt;=2.2.0-&gt;rich-&gt;trl) (0.1.2)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /root/miniconda3/lib/python3.10/site-packages (from jinja2-&gt;torch&gt;=1.13.0-&gt;peft) (2.1.5)
Requirement already satisfied: mpmath&lt;1.4.0,&gt;=1.1.0 in /root/miniconda3/lib/python3.10/site-packages (from sympy-&gt;torch&gt;=1.13.0-&gt;peft) (1.3.0)
[33mWARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m[33m
[0mNote: you may need to restart the kernel to use updated packages.
Looking in indexes: http://mirrors.aliyun.com/pypi/simple
Requirement already satisfied: ipywidgets in /root/miniconda3/lib/python3.10/site-packages (8.1.3)
Requirement already satisfied: widgetsnbextension in /root/miniconda3/lib/python3.10/site-packages (4.0.11)
Requirement already satisfied: jupyterlab-widgets~=3.0.11 in /root/miniconda3/lib/python3.10/site-packages (from ipywidgets) (3.0.11)
Requirement already satisfied: comm&gt;=0.1.3 in /root/miniconda3/lib/python3.10/site-packages (from ipywidgets) (0.2.2)
Requirement already satisfied: traitlets&gt;=4.3.1 in /root/miniconda3/lib/python3.10/site-packages (from ipywidgets) (5.14.3)
Requirement already satisfied: ipython&gt;=6.1.0 in /root/miniconda3/lib/python3.10/site-packages (from ipywidgets) (8.25.0)
Requirement already satisfied: exceptiongroup in /root/miniconda3/lib/python3.10/site-packages (from ipython&gt;=6.1.0-&gt;ipywidgets) (1.2.1)
Requirement already satisfied: decorator in /root/miniconda3/lib/python3.10/site-packages (from ipython&gt;=6.1.0-&gt;ipywidgets) (5.1.1)
Requirement already satisfied: typing-extensions&gt;=4.6 in /root/miniconda3/lib/python3.10/site-packages (from ipython&gt;=6.1.0-&gt;ipywidgets) (4.12.2)
Requirement already satisfied: pexpect&gt;4.3 in /root/miniconda3/lib/python3.10/site-packages (from ipython&gt;=6.1.0-&gt;ipywidgets) (4.9.0)
Requirement already satisfied: jedi&gt;=0.16 in /root/miniconda3/lib/python3.10/site-packages (from ipython&gt;=6.1.0-&gt;ipywidgets) (0.19.1)
Requirement already satisfied: matplotlib-inline in /root/miniconda3/lib/python3.10/site-packages (from ipython&gt;=6.1.0-&gt;ipywidgets) (0.1.7)
Requirement already satisfied: stack-data in /root/miniconda3/lib/python3.10/site-packages (from ipython&gt;=6.1.0-&gt;ipywidgets) (0.6.3)
Requirement already satisfied: prompt-toolkit&lt;3.1.0,&gt;=3.0.41 in /root/miniconda3/lib/python3.10/site-packages (from ipython&gt;=6.1.0-&gt;ipywidgets) (3.0.47)
Requirement already satisfied: pygments&gt;=2.4.0 in /root/miniconda3/lib/python3.10/site-packages (from ipython&gt;=6.1.0-&gt;ipywidgets) (2.18.0)
Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.3 in /root/miniconda3/lib/python3.10/site-packages (from jedi&gt;=0.16-&gt;ipython&gt;=6.1.0-&gt;ipywidgets) (0.8.4)
Requirement already satisfied: ptyprocess&gt;=0.5 in /root/miniconda3/lib/python3.10/site-packages (from pexpect&gt;4.3-&gt;ipython&gt;=6.1.0-&gt;ipywidgets) (0.7.0)
Requirement already satisfied: wcwidth in /root/miniconda3/lib/python3.10/site-packages (from prompt-toolkit&lt;3.1.0,&gt;=3.0.41-&gt;ipython&gt;=6.1.0-&gt;ipywidgets) (0.2.13)
Requirement already satisfied: asttokens&gt;=2.1.0 in /root/miniconda3/lib/python3.10/site-packages (from stack-data-&gt;ipython&gt;=6.1.0-&gt;ipywidgets) (2.4.1)
Requirement already satisfied: executing&gt;=1.2.0 in /root/miniconda3/lib/python3.10/site-packages (from stack-data-&gt;ipython&gt;=6.1.0-&gt;ipywidgets) (2.0.1)
Requirement already satisfied: pure-eval in /root/miniconda3/lib/python3.10/site-packages (from stack-data-&gt;ipython&gt;=6.1.0-&gt;ipywidgets) (0.2.2)
Requirement already satisfied: six&gt;=1.12.0 in /root/miniconda3/lib/python3.10/site-packages (from asttokens&gt;=2.1.0-&gt;stack-data-&gt;ipython&gt;=6.1.0-&gt;ipywidgets) (1.16.0)
[33mWARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m[33m
[0mNote: you may need to restart the kernel to use updated packages.
</code></pre><pre><code class="lang-python">import subprocess
import os
import wandb

ON_AUTODL_ENV = True
if ON_AUTODL_ENV:
    result = subprocess.run(&#39;bash -c &quot;source /etc/network_turbo &amp;&amp; env | grep proxy&quot;&#39;, shell=True, capture_output=True, text=True)
    output = result.stdout
    for line in output.splitlines():
        if &#39;=&#39; in line:
            var, value = line.split(&#39;=&#39;, 1)
            os.environ[var] = value
print(f&quot;ON_AUTODL_ENV: &#123;ON_AUTODL_ENV&#125;&quot;)

TRAINER_EXP_NAME = &quot;qlora_finetune_codegen350M&quot;
RUN_NOTEBOOK_NAME = &quot;qlora_finetune_codegen350M.ipynb&quot;

from huggingface_hub import login
login(token=&quot;your keys&quot;)
os.environ[&quot;WANDB_NOTEBOOK_NAME&quot;] = f&quot;&#123;RUN_NOTEBOOK_NAME&#125;.ipynb&quot;  # 替换为实际文件名
wandb.init(project=f&quot;&#123;RUN_NOTEBOOK_NAME&#125;&quot;)

import torch
from transformers import AutoTokenizer, AutoModelForCausalLM, Trainer, TrainingArguments
from datasets import load_dataset

if torch.backends.mps.is_available():
    print(f&quot;torch.backeds.mps.is_available(): &#123;torch.backends.mps.is_available()&#125;&quot;)
    device = torch.device(&quot;mps&quot; if torch.backends.mps.is_available() else &quot;cpu&quot;)
elif torch.cuda.is_available():
    print(f&quot;torch.cuda.is_available(): &#123;torch.cuda.is_available()&#125;&quot;)
    device = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;)
</code></pre>
<pre><code>ON_AUTODL_ENV: True


[34m[1mwandb[0m: [33mWARNING[0m WANDB_NOTEBOOK_NAME should be a path to a notebook file, couldn&#39;t find qlora_finetune_codegen350M.ipynb.ipynb.
[34m[1mwandb[0m: Currently logged in as: [33mgoldandrabbit[0m ([33mgoldandrabbit-g-r[0m) to [32mhttps://api.wandb.ai[0m. Use [1m`wandb login --relogin`[0m to force relogin
</code></pre><p>Tracking run with wandb version 0.19.10</p>
<p>Run data is saved locally in <code>/root/z_notebooks/wandb/run-20250505_140817-0q8dlrxv</code></p>
<p>Syncing run <strong><a href='https://wandb.ai/goldandrabbit-g-r/qlora_finetune_codegen350M.ipynb/runs/0q8dlrxv' target="_blank">elegant-commander-6</a></strong> to <a href='https://wandb.ai/goldandrabbit-g-r/qlora_finetune_codegen350M.ipynb' target="_blank">Weights &amp; Biases</a> (<a href='https://wandb.me/developer-guide' target="_blank">docs</a>)<br></p>
<p>View project at <a href='https://wandb.ai/goldandrabbit-g-r/qlora_finetune_codegen350M.ipynb' target="_blank">https://wandb.ai/goldandrabbit-g-r/qlora_finetune_codegen350M.ipynb</a></p>
<p>View run at <a href='https://wandb.ai/goldandrabbit-g-r/qlora_finetune_codegen350M.ipynb/runs/0q8dlrxv' target="_blank">https://wandb.ai/goldandrabbit-g-r/qlora_finetune_codegen350M.ipynb/runs/0q8dlrxv</a></p>
<pre><code>torch.cuda.is_available(): True
</code></pre><pre><code class="lang-python">import torch
from datasets import load_dataset
from transformers import AutoTokenizer, AutoModelForCausalLM, BitsAndBytesConfig, TrainingArguments
from peft import LoraConfig, prepare_model_for_kbit_training, get_peft_model, AutoPeftModelForCausalLM
</code></pre>
<h2 id="微调数据集-python-python-code-instructions-18k-alpaca"><a href="#微调数据集-python-python-code-instructions-18k-alpaca" class="headerlink" title="微调数据集: python python_code_instructions_18k_alpaca"></a>微调数据集: python python_code_instructions_18k_alpaca</h2><p>iamtarun/python_code_instructions_18k_alpaca 是个代码生成数据集,<br>dataset card: <a target="_blank" rel="noopener" href="https://huggingface.co/datasets/iamtarun/python_code_instructions_18k_alpaca">https://huggingface.co/datasets/iamtarun/python_code_instructions_18k_alpaca</a></p>
<pre><code class="lang-bash">instruction
Write a Python code to get the third largest element in a given row.

input
[12, 13, 13, 45, 22, 99]

output
def third_largest(lst): if len(lst) &lt; 3: return distinct = [] for i in lst: if i not in distinct: distinct.append(i) distinct.sort(reverse=True) return distinct[2]

prompt:
Below is an instruction that describes a task. Write a response that appropriately completes the request. ### Instruction: Write a Python code to get the third largest element in a given row. ### Input: [12, 13, 13, 45, 22, 99] ### Output: def third_largest(lst): if len(lst) &lt; 3: return distinct = [] for i in lst: if i not in distinct: distinct.append(i) distinct.sort(reverse=True) return distinct[2]
</code></pre>
<pre><code class="lang-python">dataset = load_dataset(&quot;iamtarun/python_code_instructions_18k_alpaca&quot;, split=&quot;train&quot;)
dataset = dataset.remove_columns([&quot;prompt&quot;])
</code></pre>
<pre><code class="lang-python">dataset
</code></pre>
<pre><code>Dataset(&#123;
    features: [&#39;instruction&#39;, &#39;input&#39;, &#39;output&#39;],
    num_rows: 18612
&#125;)
</code></pre><pre><code class="lang-python">dataset[0]
</code></pre>
<pre><code>&#123;&#39;instruction&#39;: &#39;Create a function to calculate the sum of a sequence of integers.&#39;,
 &#39;input&#39;: &#39;[1, 2, 3, 4, 5]&#39;,
 &#39;output&#39;: &#39;# Python code\ndef sum_sequence(sequence):\n  sum = 0\n  for num in sequence:\n    sum += num\n  return sum&#39;&#125;
</code></pre><pre><code class="lang-python">dataset[1]
</code></pre>
<pre><code>&#123;&#39;instruction&#39;: &#39;Generate a Python code for crawling a website for a specific type of data.&#39;,
 &#39;input&#39;: &#39;website: www.example.com \ndata to crawl: phone numbers&#39;,
 &#39;output&#39;: &quot;import requests\nimport re\n\ndef crawl_website_for_phone_numbers(website):\n    response = requests.get(website)\n    phone_numbers = re.findall(&#39;\\d&#123;3&#125;-\\d&#123;3&#125;-\\d&#123;4&#125;&#39;, response.text)\n    return phone_numbers\n    \nif __name__ == &#39;__main__&#39;:\n    print(crawl_website_for_phone_numbers(&#39;www.example.com&#39;))&quot;&#125;
</code></pre><pre><code class="lang-python">dataset[15]
</code></pre>
<pre><code>&#123;&#39;instruction&#39;: &#39;Collate a machine learning model in Python that distinguishes between cats and dogs.&#39;,
 &#39;input&#39;: &#39;A dataset of 800 images of cats and dogs&#39;,
 &#39;output&#39;: &quot;import numpy as np\nimport keras\nfrom keras.layers import Dense, Conv2D, MaxPooling2D, Dropout, Flatten\nfrom keras.models import Sequential\nfrom keras.preprocessing.image import ImageDataGenerator\n\n# Create the neural network model\nmodel = Sequential()\n\n# Input layer\nmodel.add(Conv2D(32, (3, 3), input_shape = (64, 64, 3), activation = &#39;relu&#39;))\n\n# Hidden layers\nmodel.add(MaxPooling2D(pool_size = (2, 2)))\nmodel.add(Dropout(0.3))\nmodel.add(Conv2D(64, (3, 3), activation = &#39;relu&#39;))\nmodel.add(MaxPooling2D(pool_size = (2, 2)))\nmodel.add(Dropout(0.3))\nmodel.add(Conv2D(64, (3, 3), activation = &#39;relu&#39;))\nmodel.add(MaxPooling2D(pool_size = (2, 2)))\nmodel.add(Dropout(0.3))\n\n# Output layer\nmodel.add(Flatten())\nmodel.add(Dense(units = 128, activation = &#39;relu&#39;))\nmodel.add(Dense(units = 1, activation = &#39;sigmoid&#39;))\n\n# Compile the model\nmodel.compile(loss = &#39;binary_crossentropy&#39;, optimizer = &#39;adam&#39;, metrics = [&#39;accuracy&#39;])\n\n# Create data generator\ndatagen = ImageDataGenerator(rescale = 1./255, shear_range = 0.2, zoom_range = 0.2, horizontal_flip = True)\n\n# Fit the model\ntrain_generator = datagen.flow_from_directory(directory = &#39;/path/to/dataset&#39;, target_size = (64, 64), color_mode = &#39;rgb&#39;, class_mode = &#39;binary&#39;, batch_size = 32)\nmodel.fit_generator(generator = train_generator, steps_per_epoch = 800, epochs = 5, validation_data = test_generator, validation_steps = 200)&quot;&#125;
</code></pre><h2 id="搭建-QLoRA-微调-Pipeline"><a href="#搭建-QLoRA-微调-Pipeline" class="headerlink" title="搭建 QLoRA 微调 Pipeline"></a>搭建 QLoRA 微调 Pipeline</h2><p>1.定义 base_model, 其实就是我们 load 预训练的模型之外包一层量化相关配置<br>这里通过配置 bnb_config 生效 4 bit 量化<br>2.定义 lora_config: 实例化一个 LoraConfig()<br>(i). 配置 lora low-rank 的 r<br>(ii). 配置 task_type, 我们选择 CASUAL_LM<br>3.Token config, 常规配置<br>4.定义 SFTTrainer, SFTTrainer 是来自于 trl 这个库<br>这里根据我们要做的代码生成任务 SFTTrainer 配置带一个代码生成的 prompt 模板, 这样我们就不需要手动处理数据适配生成模板, 然后开启微调 train()<br>5.merge adapter, 保存模型</p>
<pre><code class="lang-python">bnb_config = BitsAndBytesConfig(
    load_in_4bit=True,
    bnb_4bit_quant_type=&quot;nf4&quot;,
    bnb_4bit_compute_dtype=torch.bfloat16,
    bnb_4bit_use_double_quant=True
)
</code></pre>
<pre><code class="lang-python">from accelerate import Accelerator

# 在训练代码前添加 accelerator 初始化
accelerator = Accelerator()
print(f&#39;accelerator.process_index: &#123;accelerator.process_index&#125;&#39;)
</code></pre>
<pre><code>accelerator.process_index: 0
</code></pre><h2 id="微调模型-Salesforce-codegen-350M-mono"><a href="#微调模型-Salesforce-codegen-350M-mono" class="headerlink" title="微调模型 Salesforce/codegen-350M-mono"></a>微调模型 Salesforce/codegen-350M-mono</h2><p>CodeGen 是个生成代码的模型: 350M/2B/6B/16B, 我们先微调 350M<br>model_card: <a target="_blank" rel="noopener" href="https://huggingface.co/Salesforce/codegen-350M-mono">https://huggingface.co/Salesforce/codegen-350M-mono</a></p>
<pre><code class="lang-python">model = AutoModelForCausalLM.from_pretrained(
    &quot;Salesforce/codegen-350M-mono&quot;,
    quantization_config=bnb_config,
    # device_map=&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;,
    # device_map=device,
    device_map=&#123;&quot;&quot;: accelerator.process_index&#125;,
    use_cache=False,
    trust_remote_code=True
)
model = prepare_model_for_kbit_training(model)
</code></pre>
<pre><code>/root/miniconda3/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Some weights of the model checkpoint at Salesforce/codegen-350M-mono were not used when initializing CodeGenForCausalLM: [&#39;transformer.h.0.attn.causal_mask&#39;, &#39;transformer.h.1.attn.causal_mask&#39;, &#39;transformer.h.10.attn.causal_mask&#39;, &#39;transformer.h.11.attn.causal_mask&#39;, &#39;transformer.h.12.attn.causal_mask&#39;, &#39;transformer.h.13.attn.causal_mask&#39;, &#39;transformer.h.14.attn.causal_mask&#39;, &#39;transformer.h.15.attn.causal_mask&#39;, &#39;transformer.h.16.attn.causal_mask&#39;, &#39;transformer.h.17.attn.causal_mask&#39;, &#39;transformer.h.18.attn.causal_mask&#39;, &#39;transformer.h.19.attn.causal_mask&#39;, &#39;transformer.h.2.attn.causal_mask&#39;, &#39;transformer.h.3.attn.causal_mask&#39;, &#39;transformer.h.4.attn.causal_mask&#39;, &#39;transformer.h.5.attn.causal_mask&#39;, &#39;transformer.h.6.attn.causal_mask&#39;, &#39;transformer.h.7.attn.causal_mask&#39;, &#39;transformer.h.8.attn.causal_mask&#39;, &#39;transformer.h.9.attn.causal_mask&#39;]
- This IS expected if you are initializing CodeGenForCausalLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing CodeGenForCausalLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
</code></pre><pre><code class="lang-python">model_id = &#39;Salesforce/codegen-350M-mono&#39;
tokenizer = AutoTokenizer.from_pretrained(model_id)
tokenizer.pad_token = tokenizer.eos_token

text = &quot;def hello_world():&quot;
input_ids = tokenizer(text, return_tensors=&quot;pt&quot;).to(device)
generated_ids = model.generate(**input_ids, max_length=128)

print(tokenizer.decode(generated_ids[0], skip_special_tokens=True))
</code></pre>
<pre><code>Setting `pad_token_id` to `eos_token_id`:50256 for open-end generation.


def hello_world():
    print(&quot;Hello World&quot;)

hello_world()

# 파이썬에서는 문자열을 반환하는 함수를 사용하여 문자열을 반환하는 함수를 사용하여 문자�
</code></pre><pre><code class="lang-python">for name, module in model.named_modules():
    if &quot;attn&quot; in name or &quot;attention&quot; in name:
        print(f&quot;Attention layer: &#123;name&#125;&quot;)
        for sub_name, sub_module in module.named_modules():
            print(f&quot; - Sub-module: &#123;sub_name&#125;&quot;)
</code></pre>
<pre><code>Attention layer: transformer.h.0.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.0.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.0.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.0.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.0.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.1.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.1.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.1.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.1.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.1.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.2.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.2.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.2.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.2.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.2.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.3.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.3.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.3.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.3.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.3.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.4.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.4.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.4.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.4.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.4.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.5.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.5.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.5.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.5.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.5.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.6.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.6.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.6.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.6.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.6.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.7.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.7.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.7.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.7.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.7.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.8.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.8.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.8.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.8.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.8.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.9.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.9.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.9.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.9.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.9.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.10.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.10.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.10.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.10.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.10.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.11.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.11.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.11.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.11.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.11.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.12.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.12.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.12.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.12.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.12.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.13.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.13.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.13.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.13.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.13.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.14.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.14.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.14.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.14.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.14.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.15.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.15.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.15.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.15.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.15.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.16.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.16.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.16.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.16.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.16.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.17.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.17.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.17.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.17.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.17.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.18.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.18.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.18.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.18.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.18.attn.out_proj
 - Sub-module: 
Attention layer: transformer.h.19.attn
 - Sub-module: 
 - Sub-module: attn_dropout
 - Sub-module: resid_dropout
 - Sub-module: qkv_proj
 - Sub-module: out_proj
Attention layer: transformer.h.19.attn.attn_dropout
 - Sub-module: 
Attention layer: transformer.h.19.attn.resid_dropout
 - Sub-module: 
Attention layer: transformer.h.19.attn.qkv_proj
 - Sub-module: 
Attention layer: transformer.h.19.attn.out_proj
 - Sub-module: 
</code></pre><pre><code class="lang-python">peft_config = LoraConfig(
    r=16,
    lora_alpha=16,
    # target_modules=[&#39;qkv_proj&#39;], # 这里和 sub_module 中的明明要对齐
    lora_dropout=0.1,
    bias=&quot;none&quot;,
    task_type=&quot;CAUSAL_LM&quot;
)
</code></pre>
<h2 id="定义-prompt-instruction-模板"><a href="#定义-prompt-instruction-模板" class="headerlink" title="定义 prompt instruction 模板"></a>定义 prompt instruction 模板</h2><p>把输入训练样本改写成我们想要的 prompt template, 一种方式是直接对 dataset 处理, 另一种是给到 Trainer 作为参数处理, 这里我们将这个函数给到 Trainer</p>
<pre><code class="lang-python">def prompt_instruction_format(sample):
    return f&quot;&quot;&quot;
### Instruction:
&#123;sample[&#39;instruction&#39;]&#125;

### Input:
&#123;sample[&#39;input&#39;]&#125;

### Output:
&#123;sample[&#39;output&#39;]&#125;
&quot;&quot;&quot;
</code></pre>
<pre><code class="lang-python"># 检查模板可用
sample = dataset[0]
formatted_text = prompt_instruction_format(sample)
print(formatted_text)
</code></pre>
<pre><code>### Instruction:
Create a function to calculate the sum of a sequence of integers.

### Input:
[1, 2, 3, 4, 5]

### Output:
# Python code
def sum_sequence(sequence):
  sum = 0
  for num in sequence:
    sum += num
  return sum
</code></pre><pre><code class="lang-python">import trl

print(trl.__version__)
</code></pre>
<pre><code>0.17.0
</code></pre><h2 id="定义-SFTTrainer"><a href="#定义-SFTTrainer" class="headerlink" title="定义 SFTTrainer"></a>定义 SFTTrainer</h2><p>实例化 trl 里面的 SFTTrainer, 替代了 transformers 里面的 Traniner<br>传入了个 prompt_instruction_format 控制输入 prompt 函数  </p>
<pre><code class="lang-python">LOCAL_PATH = &quot;/root/autodl-tmp&quot;
FT_MODEL_NAME=TRAINER_EXP_NAME
LOCAL_OUTPUT_PATH = f&quot;&#123;LOCAL_PATH&#125;/&#123;FT_MODEL_NAME&#125;&quot;
print(f&quot;LOCAL_OUTPUT_PATH: &#123;LOCAL_OUTPUT_PATH&#125;&quot;)

from trl import SFTTrainer

training_args = TrainingArguments(
    output_dir=LOCAL_OUTPUT_PATH,
    per_device_train_batch_size=8,
    gradient_accumulation_steps=4,
    learning_rate=2e-5,
    logging_steps=0.05,
    logging_strategy=&quot;steps&quot;,
    fp16=True,
    optim=&quot;paged_adamw_8bit&quot;,  # 改为8bit优化器
    use_cpu=False,
    save_strategy=&quot;epoch&quot;,
    num_train_epochs=3,
    logging_dir=LOCAL_OUTPUT_PATH+&#39;/log&#39;
)

trainer = SFTTrainer(
    model=model,
    train_dataset=dataset,
    peft_config=peft_config,
    formatting_func=prompt_instruction_format,
    args=training_args
)

# 添加设备检查代码
print(f&quot;Model device: &#123;model.device&#125;&quot;)
print(f&quot;Current device: &#123;accelerator.device&#125;&quot;)
</code></pre>
<pre><code>LOCAL_OUTPUT_PATH: /root/autodl-tmp/qlora_finetune_codegen350M


No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can&#39;t be set automatically within `Trainer`. Note that empty label_names list will be used instead.


Model device: cuda:0
Current device: cuda
</code></pre><pre><code class="lang-python">trainer.train()
</code></pre>
<pre><code>[34m[1mwandb[0m: [33mWARNING[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
/root/miniconda3/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(




&lt;div&gt;

  &lt;progress value=&#39;1743&#39; max=&#39;1743&#39; style=&#39;width:300px; height:20px; vertical-align: middle;&#39;&gt;&lt;/progress&gt;
  [1743/1743 33:21, Epoch 2/3]
&lt;/div&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
</code></pre><p>  <thead>
 <tr style="text-align: left;">
      <th>Step</th>
      <th>Training Loss</th>
    </tr>
  </thead><br>  <tbody>
    <tr>
      <td>88</td>
      <td>1.066100</td>
    </tr>
    <tr>
      <td>176</td>
      <td>0.948400</td>
    </tr>
    <tr>
      <td>264</td>
      <td>0.835600</td>
    </tr>
    <tr>
      <td>352</td>
      <td>0.809900</td>
    </tr>
    <tr>
      <td>440</td>
      <td>0.766200</td>
    </tr>
    <tr>
      <td>528</td>
      <td>0.768300</td>
    </tr>
    <tr>
      <td>616</td>
      <td>0.762000</td>
    </tr>
    <tr>
      <td>704</td>
      <td>0.765300</td>
    </tr>
    <tr>
      <td>792</td>
      <td>0.744000</td>
    </tr>
    <tr>
      <td>880</td>
      <td>0.768600</td>
    </tr>
    <tr>
      <td>968</td>
      <td>0.740400</td>
    </tr>
    <tr>
      <td>1056</td>
      <td>0.772900</td>
    </tr>
    <tr>
      <td>1144</td>
      <td>0.747100</td>
    </tr>
    <tr>
      <td>1232</td>
      <td>0.725800</td>
    </tr>
    <tr>
      <td>1320</td>
      <td>0.746100</td>
    </tr>
    <tr>
      <td>1408</td>
      <td>0.741000</td>
    </tr>
    <tr>
      <td>1496</td>
      <td>0.741400</td>
    </tr>
    <tr>
      <td>1584</td>
      <td>0.738400</td>
    </tr>
    <tr>
      <td>1672</td>
      <td>0.752900</td>
    </tr>
  </tbody><br>&lt;/table&gt;<p></p>
<pre><code>/root/miniconda3/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/root/miniconda3/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(





TrainOutput(global_step=1743, training_loss=0.7850063956474616, metrics=&#123;&#39;train_runtime&#39;: 2002.9908, &#39;train_samples_per_second&#39;: 27.876, &#39;train_steps_per_second&#39;: 0.87, &#39;total_flos&#39;: 4.473852407945626e+16, &#39;train_loss&#39;: 0.7850063956474616&#125;)
</code></pre><pre><code class="lang-python">trained_model = AutoPeftModelForCausalLM.from_pretrained(
    LOCAL_OUTPUT_PATH + &#39;/checkpoint-1743&#39;,
    return_dict=True,
    torch_dtype=torch.float16,
    device_map=&quot;auto&quot;,
)
</code></pre>
<pre><code>Some weights of the model checkpoint at Salesforce/codegen-350M-mono were not used when initializing CodeGenForCausalLM: [&#39;transformer.h.0.attn.causal_mask&#39;, &#39;transformer.h.1.attn.causal_mask&#39;, &#39;transformer.h.10.attn.causal_mask&#39;, &#39;transformer.h.11.attn.causal_mask&#39;, &#39;transformer.h.12.attn.causal_mask&#39;, &#39;transformer.h.13.attn.causal_mask&#39;, &#39;transformer.h.14.attn.causal_mask&#39;, &#39;transformer.h.15.attn.causal_mask&#39;, &#39;transformer.h.16.attn.causal_mask&#39;, &#39;transformer.h.17.attn.causal_mask&#39;, &#39;transformer.h.18.attn.causal_mask&#39;, &#39;transformer.h.19.attn.causal_mask&#39;, &#39;transformer.h.2.attn.causal_mask&#39;, &#39;transformer.h.3.attn.causal_mask&#39;, &#39;transformer.h.4.attn.causal_mask&#39;, &#39;transformer.h.5.attn.causal_mask&#39;, &#39;transformer.h.6.attn.causal_mask&#39;, &#39;transformer.h.7.attn.causal_mask&#39;, &#39;transformer.h.8.attn.causal_mask&#39;, &#39;transformer.h.9.attn.causal_mask&#39;]
- This IS expected if you are initializing CodeGenForCausalLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing CodeGenForCausalLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
</code></pre><p>最后我们把 LoRA 和 base model 合并下，调用的是 merge_and_unload() 这个函数</p>
<pre><code class="lang-python">lora_merged_model = trained_model.merge_and_unload()
</code></pre>
<pre><code class="lang-python">LOCAL_SAVED_MODEL_PATH = f&quot;&#123;LOCAL_OUTPUT_PATH&#125;/model&quot;
UPLOAD_MODEL_NAME = f&quot;goldandrabbit/&#123;FT_MODEL_NAME&#125;&quot;

lora_merged_model.save_pretrained(LOCAL_SAVED_MODEL_PATH, safe_serialization=True)
tokenizer.save_pretrained(LOCAL_SAVED_MODEL_PATH)

lora_merged_model.push_to_hub(UPLOAD_MODEL_NAME)
tokenizer.push_to_hub(UPLOAD_MODEL_NAME)
</code></pre>
<pre><code>model.safetensors:   0%|          | 0.00/713M [00:00&lt;?, ?B/s]


No files have been modified since last commit. Skipping to prevent empty commit.





CommitInfo(commit_url=&#39;https://huggingface.co/goldandrabbit/qlora_finetune_codegen350M/commit/c8ffec6ead8298a99b2a7b3239bab86752212327&#39;, commit_message=&#39;Upload tokenizer&#39;, commit_description=&#39;&#39;, oid=&#39;c8ffec6ead8298a99b2a7b3239bab86752212327&#39;, pr_url=None, repo_url=RepoUrl(&#39;https://huggingface.co/goldandrabbit/qlora_finetune_codegen350M&#39;, endpoint=&#39;https://huggingface.co&#39;, repo_type=&#39;model&#39;, repo_id=&#39;goldandrabbit/qlora_finetune_codegen350M&#39;), pr_revision=None, pr_num=None)
</code></pre><h2 id="微调效果评估"><a href="#微调效果评估" class="headerlink" title="微调效果评估"></a>微调效果评估</h2><p>对比 base_model 和 lora_merged_model 生成代码的质量, 看下微调是否带来生成质量的提升  </p>
<pre><code class="lang-python">instruction=&quot;Collate a machine learning model in Python that distinguishes between cats and dogs&quot;
input=&quot;A dataset of 800 images of cats and dogs&quot;
prompt = f&quot;&quot;&quot;
### Instruction:
&#123;instruction&#125;

### Input:
&#123;input&#125;

### Output:
&quot;&quot;&quot;

input_ids = tokenizer(prompt, return_tensors=&quot;pt&quot;, truncation=True).input_ids.cuda()

print(f&quot;Before Training Response:&quot;)
output_before = model.generate(input_ids=input_ids, max_new_tokens=300, do_sample=True, top_p=0.9, temperature=0.6, max_length=512)
print(f&quot;&#123;tokenizer.decode(output_before[0], skip_special_tokens=True)&#125;&quot;)
</code></pre>
<pre><code>The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input&#39;s `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:50256 for open-end generation.
Both `max_new_tokens` (=300) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)


Before Training Response:

### Instruction:
Collate a machine learning model in Python that distinguishes between cats and dogs

### Input:
A dataset of 800 images of cats and dogs

### Output:
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import confusion_matrix

# Load the dataset
data = pd.read_csv(&quot;dataset.csv&quot;)

# Split the data into training and testing data
X = data.iloc[:, :-1].values
y = data.iloc[:, -1].values
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

# Standardize the data
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)

# Create the model
model = RandomForestClassifier(n_estimators=100)

# Train the model
model.fit(X_train, y_train)

# Predict the labels
y_pred = model.predict(X_test)

# Confusion matrix
cm = confusion_matrix(y_test, y_pred)

# Print the confusion matrix
print(
</code></pre><pre><code class="lang-python">print(f&quot;After Training Response:&quot;)
outputs = lora_merged_model.generate(input_ids=input_ids, max_new_tokens=300, do_sample=True, top_p=0.9, temperature=0.6, max_length=512)
print(f&quot;&#123;tokenizer.decode(outputs[0], skip_special_tokens=True)&#125;&quot;)
</code></pre>
<pre><code>The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input&#39;s `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:50256 for open-end generation.
Both `max_new_tokens` (=300) and `max_length`(=512) seem to have been set. `max_new_tokens` will take precedence. Please refer to the documentation for more information. (https://huggingface.co/docs/transformers/main/en/main_classes/text_generation)


After Training Response:

### Instruction:
Collate a machine learning model in Python that distinguishes between cats and dogs

### Input:
A dataset of 800 images of cats and dogs

### Output:
import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

# Read the data
data = np.load(&#39;../data/cats_and_dogs.npz&#39;)
X, y = data[&#39;arr_0&#39;], data[&#39;arr_1&#39;]

# Split the data
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)

# Create the model
model = LogisticRegression()
model.fit(X_train, y_train)

# Evaluate the model
y_pred = model.predict(X_test)
acc = accuracy_score(y_test, y_pred)
print(&#39;Accuracy:&#39;, acc)

# Plot the training data
plt.scatter(X_train[:, 0], X_train[:, 1], c=y_train, cmap=&#39;viridis&#39;, edgecolors=&#39;black&#39;)
plt.show()
</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1]. <a target="_blank" rel="noopener" href="https://medium.com/@abvijaykumar/fine-tuning-llm-parameter-efficient-fine-tuning-peft-lora-qlora-part-2-d8e23877ac6f">https://medium.com/@abvijaykumar/fine-tuning-llm-parameter-efficient-fine-tuning-peft-lora-qlora-part-2-d8e23877ac6f</a>   </p>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源 goldandrabbit.github.io </span>
    </div>
</article>





    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'Ov23lijwoqgUkb9DZ1tA',
            clientSecret: '753c99770152a10a8bb951bb5dce14766d573d68',
            repo: 'goldandrabbit.github.io',
            owner: 'GoldAndRabbit',
            admin: ['goldandrabbit'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2018-2025
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().trim().split('\n').length, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 18px 3px 15px 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: ;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 602px;
    }
    .nav.fullscreen {
        margin-left: -602px;
    }
    .nav-left {
        width: 180px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 552px;
        }
        .nav.fullscreen {
            margin-left: -552px;
        }
        .nav-left {
            width: 160px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 552px;
            margin-left: -552px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #000000;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #87CEFA;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #ffffff;
    }
    
    
    .nav-right nav a.hover > span{
        color: #DC143C !important;
    }
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
